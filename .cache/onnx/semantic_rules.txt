**Semantic Validity Rules for triton:**
1. **SSA Form Rule**: All values must be defined before use, and each value can only be defined once. Values must be used within their defining block or in subsequent blocks.
2. **Type Consistency Rule**: Operation inputs and outputs must have matching types. For example, arithmetic operations require numeric types, and tensor operations require tensors of compatible shapes and element types.
3. **Region & Terminator Rules**: Every region must have a terminating operation. For example, `krnl.iterate` and `func.return` must be properly terminated with `krnl.terminate` and `func.return` respectively.
4. **Symbol References Rule**: Functions and symbols must be declared before they are referenced. This includes defining functions with `func.func` before calling them.
5. **Dialect-Specific Constraints Rule**: Specific operations have constraints that must be adhered to. For example, `krnl.find_index` requires a string, two memrefs, and an integer, and `onnx.Conv` requires specific attributes like `auto_pad`, `group`, and `strides`.
6. **Loop and Block Rules**: Loops and blocks must be properly defined and iterated. Each loop must have a corresponding `krnl.iterate` or `krnl.unroll`, and blocks must have a defined tile size.
7. **Affine Map Usage Rule**: Affine maps must be correctly defined and used in loop and block operations. The maps must match the dimensions and bounds of the loops and blocks.
8. **Memref and Tensor Rules**: Memrefs and tensors must be correctly dimensioned and typed. Operations on memrefs and tensors must respect their shapes and element types.